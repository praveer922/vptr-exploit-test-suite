#!/bin/sh
memloc=(stack heap global)
class=(independent inherited)
type=(object_bounds_overflow sub_object_bounds_overflow type_confusion use_after_free fake_object)
pointer=(vptr object_ptr)
vtable=(reuse injection)
attack_id=1

rm markdown_table.txt

echo "| Index |          Attack Type          | Memory Location | Class Heirarchy | Pointer | Vtable |" >> markdown_table.txt
echo "|-------|-------------------------------|-----------------|-----------------|---------|--------|" >> markdown_table.txt


for i in "${memloc[@]}"
do
  for j in "${class[@]}"
  do
    for k in "${type[@]}"
    do
      for l in "${pointer[@]}"
      do
        for m in "${vtable[@]}"
        do
          if [ $l == "object_ptr" ] && [ $m == "injection" ]; then
              continue
          elif [ $i == "global" ] && [ $k == "use_after_free" ]; then
              continue
          else
              echo "|$attack_id|$k|$i|$j|$l|$m|" >> markdown_table.txt
              ((attack_id++))
          fi
        done
      done
    done
  done
done
