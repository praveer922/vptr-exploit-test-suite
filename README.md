# Overview

hijack takes in five arguments:
```
$ ./hijack <memory location> <class hierarchy> <type> <pointer> <vtable>  
```

## Memory Location

`<memory location>` specifies in which memory region the attack is carried out. It has 3 possible inputs:

1. `heap`
2. `stack`
3. `global`

## Class Heirarchy

`<class heirarchy>` refers to the relationship between the objects used in the attack. It has 3 possible inputs:

1. `independent`
2. `inherited`
3. `multiple_inheritance`

## Type

`<type>` refers to the type of attack that will be carried out and has 4 possible inputs:

1. `object_bounds_overflow`
2. `sub_object_bounds_overflow`
3. `type_confusion`
4. `use_after_free`

## Pointer

`<pointer>` determines which pointer the exploit is going to target and has two possible inputs:

1. `vptr` : the exploit will overwrite the vptr in an object
2. `object_ptr` : the exploit changes the pointer to the object

## Vtable  

`<vtable>` determines the location of the vtable that the overwritten vptr points to(if any). It has 3 possible inputs:

1. `reuse` : a vtable from an existing object is used
2. `injection` : a fake vtable is created and pointed to
3. `corruption`


# Implementation

The implementation of each exploit is given here:

* heap
    * independent
        * object_bounds_overflow
            * vptr
                * reuse
                    ```
                    $ ./hijack heap independent object_bounds_overflow vptr reuse
                    ```
                    **DONE (1)**
                * injection
                    ```
                    $ ./hijack heap independent object_bounds_overflow vptr injection
                    ```
                    **DONE (13)**
                * corruption

            * object_ptr  
                  **Not possible? Independent objects.**
        * sub_object_bounds_overflow
            * vptr
                * reuse
                    ```
                    $ ./hijack heap independent sub_object_bounds_overflow vptr reuse
                    ```
                    **DONE (2)**
                * injection
                    ```
                    $ ./hijack heap independent sub_object_bounds_overflow vptr injection
                    ```
                    **DONE (14)**

                * corruption
            * object_ptr
        * type_confusion
            * vptr
                * reuse
                    ```
                    $ ./hijack heap independent type_confusion vptr reuse
                    ```
                    **DONE (3)**
                * injection
                * corruption
            * object_ptr
        * use_after_free
            * vptr
                * reuse
                    ```
                    $ ./hijack heap independent use_after_free vptr reuse
                    ```
                    **DONE (4)**
                * injection
                * corruption
            * object_ptr
    * inherited
        * object_bounds_overflow
            * vptr
                * reuse
                * injection
                * corruption
            * object_ptr
        * sub_object_bounds_overflow
            * vptr
                * reuse
                * injection
                * corruption
            * object_ptr
        * type_confusion
            * vptr
                * reuse
                * injection
                * corruption
            * object_ptr
                ```
                $ ./hijack heap inherited type_confusion object_ptr
                ```
                **DONE (5)**
        * use_after_free
            * vptr
                * reuse
                * injection
                * corruption
            * object_ptr
                ```
                $ ./hijack heap inherited use_after_free object_ptr
                ```
                **DONE (6)**
    * multiple_inheritance
        * object_bounds_overflow
            * vptr
                * reuse
                * injection
                * corruption
            * object_ptr
        * sub_object_bounds_overflow
            * vptr
                * reuse
                * injection
                * corruption
            * object_ptr
        * type_confusion
            * vptr
                * reuse
                * injection
                * corruption
            * object_ptr
        * use_after_free
            * vptr
                * reuse
                * injection
                * corruption
            * object_ptr

* stack
    * independent
        * object_bounds_overflow
            * vptr
                * reuse
                    ```
                    $ ./hijack stack independent object_bounds_overflow vptr reuse
                    ```
                    **DONE (7)**
                * injection
                * corruption
            * object_ptr
        * sub_object_bounds_overflow
            * vptr
                * reuse
                    ```
                    $ ./hijack stack independent sub_object_bounds_overflow vptr reuse
                    ```
                    **DONE (8)**
                * injection
                * corruption
            * object_ptr
        * type_confusion
            * vptr
                * reuse
                    ```
                    $ ./hijack stack independent type_confusion vptr reuse
                    ```
                    **DONE (9)**
                * injection
                * corruption
            * object_ptr
        * use_after_free
            * vptr
                * reuse
                * injection
                * corruption
            * object_ptr
    * inherited
        * object_bounds_overflow
            * vptr
                * reuse
                * injection
                * corruption
            * object_ptr
                ```
                $ ./hijack stack inherited object_bounds_overflow object_ptr
                ```
                **DONE (10)**
        * sub_object_bounds_overflow
            * vptr
                * reuse
                * injection
                * corruption
            * object_ptr
        * type_confusion
            * vptr
                * reuse
                * injection
                * corruption
            * object_ptr
                ```
                $ ./hijack stack inherited type_confusion object_ptr
                ```
                **DONE (11)**
        * use_after_free
            * vptr
                * reuse
                * injection
                * corruption
            * object_ptr
                ```
                $ ./hijack stack inherited use_after_free object_ptr
                ```
                **DONE (12)**
    * multiple_inheritance
        * object_bounds_overflow
            * vptr
                * reuse
                * injection
                * corruption
            * object_ptr
        * sub_object_bounds_overflow
            * vptr
                * reuse
                * injection
                * corruption
            * object_ptr
        * type_confusion
            * vptr
                * reuse
                * injection
                * corruption
            * object_ptr
        * use_after_free
            * vptr
                * reuse
                * injection
                * corruption
            * object_ptr

* global
    * independent
        * object_bounds_overflow
            * vptr
                * reuse
                * injection
                * corruption
            * object_ptr
        * sub_object_bounds_overflow
            * vptr
                * reuse
                * injection
                * corruption
            * object_ptr
        * type_confusion
            * vptr
                * reuse
                * injection
                * corruption
            * object_ptr
        * use_after_free
            * vptr
                * reuse
                * injection
                * corruption
            * object_ptr
    * inherited
        * object_bounds_overflow
            * vptr
                * reuse
                * injection
                * corruption
            * object_ptr
        * sub_object_bounds_overflow
            * vptr
                * reuse
                * injection
                * corruption
            * object_ptr
        * type_confusion
            * vptr
                * reuse
                * injection
                * corruption
            * object_ptr
        * use_after_free
            * vptr
                * reuse
                * injection
                * corruption
            * object_ptr
    * multiple_inheritance
        * object_bounds_overflow
            * vptr
                * reuse
                * injection
                * corruption
            * object_ptr
        * sub_object_bounds_overflow
            * vptr
                * reuse
                * injection
                * corruption
            * object_ptr
        * type_confusion
            * vptr
                * reuse
                * injection
                * corruption
            * object_ptr
        * use_after_free
            * vptr
                * reuse
                * injection
                * corruption
            * object_ptr

Current Exploit: **14**
